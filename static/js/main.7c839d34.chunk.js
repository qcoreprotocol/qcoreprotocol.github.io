(this["webpackJsonpqtum-raffle"]=this["webpackJsonpqtum-raffle"]||[]).push([[0],{180:function(e,t,n){},193:function(e,t){},194:function(e,t){},233:function(e,t){},235:function(e,t){},249:function(e,t){},251:function(e,t){},282:function(e,t,n){},419:function(e,t,n){"use strict";n.r(t);var a,r=n(1),s=n(2),c=n(28),i=n.n(c),l=(n(180),n(6)),o=n.n(l),d=n(20),u=n(49),b=n(50),h=n(174),j=n(173),f=n(90),m=n(159),g=n.n(m),p=n(160),O=n.n(p),v=n(61),x=n.n(v),k=n(29),y=n.n(k),w=n(162),N=n.n(w),S=n(163),C=n.n(S),P=n(164),T=n.n(P),M=n(165),A=n.n(M),Q=n(51),R=n.n(Q),L=n(166),W=n.n(L),I=n(167),B=n.n(I),D=n(168),q=n.n(D),E=n(161),U=n.n(E),z=n(92),F=n.n(z),Z=n(158),_=n.n(Z),H=n(91),$=n.n(H),J=n(169),G=n.n(J),Y=n(170),K=n.n(Y),V=n(172),X=n.n(V),ee=n(171),te=n.n(ee),ne=n(156),ae=n(89),re=n.n(ae),se=n.p+"static/media/qtum-raffle.55e6f7c8.svg",ce=(n(282),"adcbf0ac6a351e5f0b86eec5a4df288e62abacc0"),ie=new ne.a,le=ie.DataTypes,oe=le.ADDRESS,de=le.ADDRESS_ARRAY,ue=1e8,be=Object(f.createMuiTheme)({palette:{primary:{main:"#343a40"},secondary:{main:"#e6ae49"}}}),he=function(e){Object(h.a)(n,e);var t=Object(j.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,s=new Array(r),c=0;c<r;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).state={owner:"",players:[],balance:"",hasError:!1,message:"",numberOfRaffle:"",contractLoaded:!1,loading:!1,selectedTab:0,buyPricePerRaffle:1,buyAmount:1,buyPrice:1,walletInitialized:!1},e.loadWallet=Object(d.a)(o.a.mark((function t(){var n,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ie.isQtumLightInstalled();case 2:if(!t.sent){t.next=18;break}return console.log("Qtum Light is installed!"),t.next=7,ie.getCurrentAddress();case 7:if(n=t.sent){t.next=11;break}return e.setState({walletInitialized:!0,snackbarOpen:!0,snackbarMessage:"Please sign in Qtum Light Wallet and refresh the page!"}),t.abrupt("return");case 11:e.setState({account:n,walletInitialized:!0}),e.loadData(),(a=new Date).setHours(23,59,59,999),e.startCountdownTimer(a.getTime()),t.next=20;break;case 18:console.log("Qtum Light is not installed!"),e.setState({walletInitialized:!0,snackbarOpen:!0,snackbarMessage:"Please install Qtum Light Wallet to use this app!"});case 20:case"end":return t.stop()}}),t)}))),e.loadData=Object(d.a)(o.a.mark((function t(){var n,a,r,s,c,i,l,d;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({loading:!0,loadingMessage:"Retrieving the raffle info from Qtum blockchain, please wait..."}),t.prev=1,n=ie.Contract(ce),a="TESTNET",t.next=6,n.call("owner",null,null,[oe]);case 6:return r=t.sent,t.next=9,n.call("getPlayers",null,null,[de]);case 9:return s=t.sent,c=s[0],i=ce,t.next=14,ie.queryContractInfo(ce);case 14:l=t.sent,d=l.balance/ue,e.setState({loading:!1,loadingMessage:"",raffle:n,owner:r,players:c,contractAddress:i,balance:d,network:a,contractLoaded:!0}),t.next=23;break;case 19:t.prev=19,t.t0=t.catch(1),console.error(t.t0),e.setState({loading:!1,snackbarOpen:!0,snackbarMessage:"Something went wrong, please try again."});case 23:case"end":return t.stop()}}),t,null,[[1,19]])}))),e.handleTabChange=function(t,n){e.setState({selectedTab:n})},e.addRaffles=function(t){var n=e.state.buyAmount,a=(n=parseInt(n,10)+t)*e.state.buyPricePerRaffle;e.setState({buyAmount:n,buyPrice:a})},e.getAddressAbv=function(e){return e?e.substr(0,5)+"..."+e.substr(e.length-4,4):""},e.handleBuyAmountChange=function(t){var n=t.replace(/^0+(?!\.|$)/,"").replace(/[^0-9 .]+/g,"").replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1"),a=n*e.state.buyPricePerRaffle;e.setState({buyAmount:n,buyPrice:a})},e.onBuySubmit=function(){var t=Object(d.a)(o.a.mark((function t(n){var a,r,s,c,i;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),a=e.state,r=a.buyPrice,s=a.raffle,e.setState({snackbarOpen:!0,snackbarMessage:"Please confirm the transaction in the Qtum Light Wallet to complete the purchase."}),t.prev=3,c=r*ue,t.next=7,s.send("buy",null,null,c,4e-7,25e5);case 7:return i=t.sent,e.setState({snackbarOpen:!1,loading:!0,loadingMessage:"Writing to the blockchain, please wait..."}),t.next=11,s.queryConfirmation(i);case 11:e.setState({loading:!1,snackbarOpen:!0,snackbarMessage:"Purchased successfully, good luck!"}),e.loadData(),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(3),console.error(t.t0),e.setState({loading:!1,snackbarOpen:!0,snackbarMessage:"Transaction has been cancelled, please try again."});case 19:case"end":return t.stop()}}),t,null,[[3,15]])})));return function(e){return t.apply(this,arguments)}}(),e.onPickWinnerSubmit=function(){var t=Object(d.a)(o.a.mark((function t(n){var a,r,s,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),a=e.state,r=a.raffle,0!==(s=a.balance)&&"0"!==s){t.next=5;break}return e.setState({snackbarOpen:!0,snackbarMessage:"No QTUM in the contract!"}),t.abrupt("return");case 5:return e.setState({snackbarOpen:!0,snackbarMessage:"Please confirm the transaction in the Qtum Light Wallet to complete the operation."}),t.prev=6,t.next=9,r.send("pickWinner");case 9:return c=t.sent,e.setState({snackbarOpen:!1,loading:!0,loadingMessage:"Writing to the blockchain, please wait..."}),t.next=13,r.queryConfirmation(c);case 13:e.setState({loading:!1,snackbarOpen:!0,snackbarMessage:"Picked owner successfully! All Qtum has transferred to the winner!"}),e.loadData(),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(6),console.error(t.t0),e.setState({loading:!1,snackbarOpen:!0,snackbarMessage:"Something went wrong! Make sure you are the owner!"});case 21:case"end":return t.stop()}}),t,null,[[6,17]])})));return function(e){return t.apply(this,arguments)}}(),e.addPaddingZeroIfNeeded=function(e){return 0===e?"00":e<10&&e>0?"0"+e:e},e.startCountdownTimer=function(t){if(e.state.endTime!==t){var n=t-(new Date).getTime(),r=re.a.duration(n,"milliseconds");a&&clearInterval(a),a=setInterval((function(){r=re.a.duration(r-1e3,"milliseconds");var t=e.addPaddingZeroIfNeeded(r.hours()),n=e.addPaddingZeroIfNeeded(r.minutes()),a=e.addPaddingZeroIfNeeded(r.seconds()),s="".concat(t," : ").concat(n," : ").concat(a);e.setState({countdownTimer:s})}),1e3),e.setState({endTime:t})}},e.handleSnackbarClose=function(t,n){"clickaway"!==n&&e.setState({snackbarOpen:!1})},e}return Object(b.a)(n,[{key:"componentDidMount",value:function(){this.loadWallet()}},{key:"renderBuy",value:function(){var e=this,t=this.state,n=t.selectedTab,a=t.balance,s=t.owner;return Object(r.jsxs)(R.a,{className:"card big-card",children:[Object(r.jsxs)(_.a,{value:n,onChange:this.handleTabChange,children:[Object(r.jsx)($.a,{label:"Buy"}),Object(r.jsx)($.a,{label:"Pick winner"})]}),0===n&&Object(r.jsxs)("div",{children:[Object(r.jsx)("p",{children:"* The price 1 QTUM per raffle."}),Object(r.jsxs)("div",{className:"buy-box",children:[Object(r.jsx)("div",{className:"buy-icon",children:Object(r.jsx)(F.a,{})}),Object(r.jsx)("input",{required:!0,className:"buy-amount",value:this.state.buyAmount,onChange:function(t){return e.handleBuyAmountChange(t.target.value)},type:"number",margin:"normal"}),Object(r.jsx)("div",{className:"buy-price right",children:Object(r.jsxs)("div",{children:["@ ",this.state.buyPrice," QTUM"]})})]}),Object(r.jsxs)("div",{className:"keys-container",children:[Object(r.jsx)(y.a,{className:"key-button",variant:"outlined",color:"secondary",onClick:function(){return e.addRaffles(1)},children:"+1 Raffle"}),Object(r.jsx)(y.a,{className:"key-button",variant:"outlined",color:"secondary",onClick:function(){return e.addRaffles(2)},children:"+2 Raffles"}),Object(r.jsx)(y.a,{className:"key-button",variant:"outlined",color:"secondary",onClick:function(){return e.addRaffles(5)},children:"+5"}),Object(r.jsx)(y.a,{className:"key-button",variant:"outlined",color:"secondary",onClick:function(){return e.addRaffles(10)},children:"+10"}),Object(r.jsx)(y.a,{className:"key-button",variant:"outlined",color:"secondary",onClick:function(){return e.addRaffles(100)},children:"+100"})]}),Object(r.jsx)(y.a,{id:"buy-button",variant:"raised",color:"primary",onClick:this.onBuySubmit,children:"Buy"})]}),1===n&&Object(r.jsxs)("div",{children:[Object(r.jsx)("p",{children:"* Only the owner can pick a winner."}),Object(r.jsxs)("div",{className:"round-info-container",children:[Object(r.jsxs)("div",{className:"round-info",children:[Object(r.jsx)("span",{children:"Balance"}),Object(r.jsxs)("span",{children:[a," QTUM"]})]}),Object(r.jsxs)("div",{className:"round-info",children:[Object(r.jsx)("span",{children:"Owner account"}),Object(r.jsx)("span",{children:s})]})]}),Object(r.jsx)(y.a,{id:"claim-button",variant:"raised",color:"primary",onClick:this.onPickWinnerSubmit,children:"Pick Winner"})]})]})}},{key:"renderContractInfo",value:function(){var e=this.state,t=e.contractAddress,n=e.balance,a="//testnet.qtum.info/contract/".concat(t);return Object(r.jsx)(R.a,{className:"card small-card",children:Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{className:"card-title",children:"Smart Contract"}),Object(r.jsx)("hr",{className:"card-title-divider"}),Object(r.jsx)("div",{children:"Raffle will drain in:"}),Object(r.jsxs)("p",{className:"round-countdown-timer",children:[this.state.countdownTimer," "]}),Object(r.jsx)("hr",{}),Object(r.jsxs)("div",{className:"round-info",children:[Object(r.jsx)("span",{children:"Total QTUM"}),Object(r.jsxs)("span",{children:[n," QTUM"]})]}),Object(r.jsxs)("div",{className:"round-info",children:[Object(r.jsx)("span",{children:"Contract Address"}),Object(r.jsx)("a",{href:a,target:"_blank",className:"contract-link",children:this.getAddressAbv(t)})]}),Object(r.jsxs)("div",{className:"round-info",children:[Object(r.jsx)("span",{children:"Source Code"}),Object(r.jsx)("a",{href:"https://github.com/QtumLightProject/qtum-raffle",target:"_blank",className:"contract-link",children:"GitHub | Qtum Raffle"})]})]})})}},{key:"renderAppBar",value:function(){var e=this.state.balance||0;return Object(r.jsx)(g.a,{position:"sticky",children:Object(r.jsx)(O.a,{children:Object(r.jsxs)("div",{className:"tool-bar",children:[Object(r.jsx)(x.a,{variant:"title",color:"inherit",children:Object(r.jsx)("div",{className:"trademark",children:"QTUM RAFFLE\u2122"})}),Object(r.jsxs)("div",{className:"appbar-info",children:[Object(r.jsx)(U.a,{})," ",Object(r.jsx)("div",{children:this.state.countdownTimer}),Object(r.jsx)(F.a,{})," ",Object(r.jsx)("div",{children:e})]})]})})})}},{key:"renderSummary",value:function(){var e=this.state.balance;return Object(r.jsxs)("div",{className:"App",children:[Object(r.jsxs)("div",{className:"total-qtum",children:[Object(r.jsx)("img",{src:se,alt:"Qtum Raffle"}),Object(r.jsxs)("div",{children:[e," QTUM"]})]}),Object(r.jsxs)("div",{className:"countdown-timer",children:[this.state.countdownTimer," "]})]})}},{key:"renderLoading",value:function(){return Object(r.jsxs)(N.a,{open:this.state.loading,keepMounted:!0,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(r.jsx)(C.a,{children:Object(r.jsx)(T.a,{id:"alert-dialog-description",children:this.state.loadingMessage})}),Object(r.jsx)(A.a,{})]})}},{key:"renderSnackbar",value:function(){return Object(r.jsx)(W.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:this.state.snackbarOpen,autoHideDuration:6e3,onClose:this.handleSnackbarClose,ContentProps:{"aria-describedby":"message-id"},message:Object(r.jsx)("span",{id:"message-id",children:this.state.snackbarMessage}),action:[Object(r.jsx)(B.a,{"aria-label":"Close",color:"inherit",onClick:this.handleSnackbarClose,children:Object(r.jsx)(q.a,{})},"close")]})}},{key:"renderFooter",value:function(){return Object(r.jsx)("footer",{children:Object(r.jsx)("div",{className:"footer-container",children:Object(r.jsxs)("p",{children:["\xa9 2018 QTUM RAFFLE\u2122 | Please install the ",Object(r.jsx)("a",{href:"https://github.com/QtumLightProject/qtum-light-wallet",target:"_blank",children:" Qtum Light Wallet"})," to play this game | Contact: appbery.digital@gmail.com "]})})})}},{key:"renderPlayers",value:function(){var e=this.state.players;return e&&e.length>0?(e.length>4&&(e=e.slice(0,4)),Object(r.jsxs)(R.a,{className:"card small-card",children:[Object(r.jsx)("div",{className:"card-title",children:"Recent Players"}),Object(r.jsx)("hr",{className:"card-title-divider"}),Object(r.jsx)(G.a,{children:Object(r.jsx)(K.a,{children:e.map((function(e,t){return Object(r.jsx)(te.a,{children:Object(r.jsx)(X.a,{className:"table-cell",children:e})},t)}))})})]})):Object(r.jsxs)(R.a,{className:"card small-card",children:[Object(r.jsx)("div",{className:"card-title",children:"Recent Players"}),Object(r.jsx)("hr",{className:"card-title-divider"}),Object(r.jsx)("p",{children:"No players yet, be quick to be the first!"})]})}},{key:"renderBody",value:function(){var e=this.state,t=e.account;return e.walletInitialized?t?Object(r.jsxs)("div",{className:"main-container",children:[this.renderPlayers(),this.renderBuy(),this.renderContractInfo()]}):Object(r.jsx)("h2",{children:"Please sign in Qtum Light Wallet and refresh the page!"}):null}},{key:"render",value:function(){return Object(r.jsx)(f.MuiThemeProvider,{theme:be,children:Object(r.jsxs)("div",{className:"App",children:[this.renderAppBar(),this.renderSummary(),this.renderBody(),this.renderLoading(),this.renderSnackbar(),this.renderFooter()]})})}}]),n}(s.Component),je=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function fe(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(Object(r.jsx)(he,{}),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("","/service-worker.js");je?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):fe(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):fe(e)}))}}()}},[[419,1,2]]]);
//# sourceMappingURL=main.7c839d34.chunk.js.map