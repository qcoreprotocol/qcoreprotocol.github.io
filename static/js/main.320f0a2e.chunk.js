(this["webpackJsonpqtum-raffle"]=this["webpackJsonpqtum-raffle"]||[]).push([[0],{180:function(e,t,a){},193:function(e,t){},194:function(e,t){},233:function(e,t){},235:function(e,t){},249:function(e,t){},251:function(e,t){},282:function(e,t,a){},419:function(e,t,a){"use strict";a.r(t);var n,r=a(1),c=a(2),s=a(28),i=a.n(s),l=(a(180),a(6)),o=a.n(l),d=a(20),u=a(49),b=a(50),h=a(174),j=a(173),f=a(90),m=a(159),p=a.n(m),g=a(160),O=a.n(g),v=a(61),x=a.n(v),k=a(29),y=a.n(k),w=a(162),N=a.n(w),S=a(163),C=a.n(S),P=a(164),T=a.n(P),M=a(165),A=a.n(M),Q=a(51),R=a.n(Q),L=a(166),W=a.n(L),I=a(167),B=a.n(I),D=a(168),q=a.n(D),E=a(161),U=a.n(E),z=a(92),F=a.n(z),_=a(158),Z=a.n(_),H=a(91),$=a.n(H),J=a(169),Y=a.n(J),G=a(170),K=a.n(G),V=a(172),X=a.n(V),ee=a(171),te=a.n(ee),ae=a(156),ne=a(89),re=a.n(ne),ce=a.p+"static/media/qtum-raffle.55e6f7c8.svg",se=(a(282),"adcbf0ac6a351e5f0b86eec5a4df288e62abacc0"),ie=new ae.a,le=ie.DataTypes,oe=le.ADDRESS,de=le.ADDRESS_ARRAY,ue=1e8,be=Object(f.createMuiTheme)({palette:{primary:{main:"#343a40"},secondary:{main:"#e6ae49"}}}),he=function(e){Object(h.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(u.a)(this,a);for(var r=arguments.length,c=new Array(r),s=0;s<r;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).state={owner:"",players:[],balance:"",hasError:!1,message:"",numberOfRaffle:"",contractLoaded:!1,loading:!1,selectedTab:0,buyPricePerRaffle:1,buyAmount:1,buyPrice:1,walletInitialized:!1},e.loadWallet=Object(d.a)(o.a.mark((function t(){var a,n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return window.postMessage({message:{type:"CONNECT_QRYPTO"}},"*"),t.next=3,ie.isQtumLightInstalled();case 3:if(!t.sent){t.next=19;break}return console.log("Qtum Light is installed!"),t.next=8,ie.getCurrentAddress();case 8:if(a=t.sent){t.next=12;break}return e.setState({walletInitialized:!0,snackbarOpen:!0,snackbarMessage:"Please sign in Qtum Light Wallet and refresh the page!"}),t.abrupt("return");case 12:e.setState({account:a,walletInitialized:!0}),e.loadData(),(n=new Date).setHours(23,59,59,999),e.startCountdownTimer(n.getTime()),t.next=21;break;case 19:console.log("Qtum Light is not installed!"),e.setState({walletInitialized:!0,snackbarOpen:!0,snackbarMessage:"Please install Qtum Light Wallet to use this app!"});case 21:case"end":return t.stop()}}),t)}))),e.loadData=Object(d.a)(o.a.mark((function t(){var a,n,r,c,s,i,l,d;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"adcbf0ac6a351e5f0b86eec5a4df288e62abacc0","06fdde03",window.qrypto.rpcProvider.rawCall("callcontract",["adcbf0ac6a351e5f0b86eec5a4df288e62abacc0","06fdde03"]).then((function(e){return console.log(e)})),e.setState({loading:!0,loadingMessage:"Retrieving the raffle info from Qtum blockchain, please wait..."}),t.prev=4,a=ie.Contract(se),n="TESTNET",t.next=9,a.call("owner",null,null,[oe]);case 9:return r=t.sent,t.next=12,a.call("getPlayers",null,null,[de]);case 12:return c=t.sent,s=c[0],i=se,t.next=17,ie.queryContractInfo(se);case 17:l=t.sent,d=l.balance/ue,e.setState({loading:!1,loadingMessage:"",raffle:a,owner:r,players:s,contractAddress:i,balance:d,network:n,contractLoaded:!0}),t.next=26;break;case 22:t.prev=22,t.t0=t.catch(4),console.error(t.t0),e.setState({loading:!1,snackbarOpen:!0,snackbarMessage:"Something went wrong, please try again."});case 26:case"end":return t.stop()}}),t,null,[[4,22]])}))),e.handleTabChange=function(t,a){e.setState({selectedTab:a})},e.addRaffles=function(t){var a=e.state.buyAmount,n=(a=parseInt(a,10)+t)*e.state.buyPricePerRaffle;e.setState({buyAmount:a,buyPrice:n})},e.getAddressAbv=function(e){return e?e.substr(0,5)+"..."+e.substr(e.length-4,4):""},e.handleBuyAmountChange=function(t){var a=t.replace(/^0+(?!\.|$)/,"").replace(/[^0-9 .]+/g,"").replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1"),n=a*e.state.buyPricePerRaffle;e.setState({buyAmount:a,buyPrice:n})},e.onBuySubmit=function(){var t=Object(d.a)(o.a.mark((function t(a){var n,r,c,s,i;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),n=e.state,r=n.buyPrice,c=n.raffle,e.setState({snackbarOpen:!0,snackbarMessage:"Please confirm the transaction in the Qtum Light Wallet to complete the purchase."}),t.prev=3,s=r*ue,t.next=7,c.send("buy",null,null,s,4e-7,25e5);case 7:return i=t.sent,e.setState({snackbarOpen:!1,loading:!0,loadingMessage:"Writing to the blockchain, please wait..."}),t.next=11,c.queryConfirmation(i);case 11:e.setState({loading:!1,snackbarOpen:!0,snackbarMessage:"Purchased successfully, good luck!"}),e.loadData(),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(3),console.error(t.t0),e.setState({loading:!1,snackbarOpen:!0,snackbarMessage:"Transaction has been cancelled, please try again."});case 19:case"end":return t.stop()}}),t,null,[[3,15]])})));return function(e){return t.apply(this,arguments)}}(),e.onPickWinnerSubmit=function(){var t=Object(d.a)(o.a.mark((function t(a){var n,r,c,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),n=e.state,r=n.raffle,0!==(c=n.balance)&&"0"!==c){t.next=5;break}return e.setState({snackbarOpen:!0,snackbarMessage:"No QTUM in the contract!"}),t.abrupt("return");case 5:return e.setState({snackbarOpen:!0,snackbarMessage:"Please confirm the transaction in the Qtum Light Wallet to complete the operation."}),t.prev=6,t.next=9,r.send("pickWinner");case 9:return s=t.sent,e.setState({snackbarOpen:!1,loading:!0,loadingMessage:"Writing to the blockchain, please wait..."}),t.next=13,r.queryConfirmation(s);case 13:e.setState({loading:!1,snackbarOpen:!0,snackbarMessage:"Picked owner successfully! All Qtum has transferred to the winner!"}),e.loadData(),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(6),console.error(t.t0),e.setState({loading:!1,snackbarOpen:!0,snackbarMessage:"Something went wrong! Make sure you are the owner!"});case 21:case"end":return t.stop()}}),t,null,[[6,17]])})));return function(e){return t.apply(this,arguments)}}(),e.addPaddingZeroIfNeeded=function(e){return 0===e?"00":e<10&&e>0?"0"+e:e},e.startCountdownTimer=function(t){if(e.state.endTime!==t){var a=t-(new Date).getTime(),r=re.a.duration(a,"milliseconds");n&&clearInterval(n),n=setInterval((function(){r=re.a.duration(r-1e3,"milliseconds");var t=e.addPaddingZeroIfNeeded(r.hours()),a=e.addPaddingZeroIfNeeded(r.minutes()),n=e.addPaddingZeroIfNeeded(r.seconds()),c="".concat(t," : ").concat(a," : ").concat(n);e.setState({countdownTimer:c})}),1e3),e.setState({endTime:t})}},e.handleSnackbarClose=function(t,a){"clickaway"!==a&&e.setState({snackbarOpen:!1})},e}return Object(b.a)(a,[{key:"componentDidMount",value:function(){this.loadWallet()}},{key:"renderBuy",value:function(){var e=this,t=this.state,a=t.selectedTab,n=t.balance,c=t.owner;return Object(r.jsxs)(R.a,{className:"card big-card",children:[Object(r.jsxs)(Z.a,{value:a,onChange:this.handleTabChange,children:[Object(r.jsx)($.a,{label:"Buy"}),Object(r.jsx)($.a,{label:"Pick winner"})]}),0===a&&Object(r.jsxs)("div",{children:[Object(r.jsx)("p",{children:"* The price 1 QTUM per raffle."}),Object(r.jsxs)("div",{className:"buy-box",children:[Object(r.jsx)("div",{className:"buy-icon",children:Object(r.jsx)(F.a,{})}),Object(r.jsx)("input",{required:!0,className:"buy-amount",value:this.state.buyAmount,onChange:function(t){return e.handleBuyAmountChange(t.target.value)},type:"number",margin:"normal"}),Object(r.jsx)("div",{className:"buy-price right",children:Object(r.jsxs)("div",{children:["@ ",this.state.buyPrice," QTUM"]})})]}),Object(r.jsxs)("div",{className:"keys-container",children:[Object(r.jsx)(y.a,{className:"key-button",variant:"outlined",color:"secondary",onClick:function(){return e.addRaffles(1)},children:"+1 Raffle"}),Object(r.jsx)(y.a,{className:"key-button",variant:"outlined",color:"secondary",onClick:function(){return e.addRaffles(2)},children:"+2 Raffles"}),Object(r.jsx)(y.a,{className:"key-button",variant:"outlined",color:"secondary",onClick:function(){return e.addRaffles(5)},children:"+5"}),Object(r.jsx)(y.a,{className:"key-button",variant:"outlined",color:"secondary",onClick:function(){return e.addRaffles(10)},children:"+10"}),Object(r.jsx)(y.a,{className:"key-button",variant:"outlined",color:"secondary",onClick:function(){return e.addRaffles(100)},children:"+100"})]}),Object(r.jsx)(y.a,{id:"buy-button",variant:"raised",color:"primary",onClick:this.onBuySubmit,children:"Buy"})]}),1===a&&Object(r.jsxs)("div",{children:[Object(r.jsx)("p",{children:"* Only the owner can pick a winner."}),Object(r.jsxs)("div",{className:"round-info-container",children:[Object(r.jsxs)("div",{className:"round-info",children:[Object(r.jsx)("span",{children:"Balance"}),Object(r.jsxs)("span",{children:[n," QTUM"]})]}),Object(r.jsxs)("div",{className:"round-info",children:[Object(r.jsx)("span",{children:"Owner account"}),Object(r.jsx)("span",{children:c})]})]}),Object(r.jsx)(y.a,{id:"claim-button",variant:"raised",color:"primary",onClick:this.onPickWinnerSubmit,children:"Pick Winner"})]})]})}},{key:"renderContractInfo",value:function(){var e=this.state,t=e.contractAddress,a=e.balance,n="//testnet.qtum.info/contract/".concat(t);return Object(r.jsx)(R.a,{className:"card small-card",children:Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{className:"card-title",children:"Smart Contract"}),Object(r.jsx)("hr",{className:"card-title-divider"}),Object(r.jsx)("div",{children:"Raffle will drain in:"}),Object(r.jsxs)("p",{className:"round-countdown-timer",children:[this.state.countdownTimer," "]}),Object(r.jsx)("hr",{}),Object(r.jsxs)("div",{className:"round-info",children:[Object(r.jsx)("span",{children:"Total QTUM"}),Object(r.jsxs)("span",{children:[a," QTUM"]})]}),Object(r.jsxs)("div",{className:"round-info",children:[Object(r.jsx)("span",{children:"Contract Address"}),Object(r.jsx)("a",{href:n,target:"_blank",className:"contract-link",children:this.getAddressAbv(t)})]}),Object(r.jsxs)("div",{className:"round-info",children:[Object(r.jsx)("span",{children:"Source Code"}),Object(r.jsx)("a",{href:"https://github.com/QtumLightProject/qtum-raffle",target:"_blank",className:"contract-link",children:"GitHub | Qtum Raffle"})]})]})})}},{key:"renderAppBar",value:function(){var e=this.state.balance||0;return Object(r.jsx)(p.a,{position:"sticky",children:Object(r.jsx)(O.a,{children:Object(r.jsxs)("div",{className:"tool-bar",children:[Object(r.jsx)(x.a,{variant:"title",color:"inherit",children:Object(r.jsx)("div",{className:"trademark",children:"QTUM RAFFLE\u2122"})}),Object(r.jsxs)("div",{className:"appbar-info",children:[Object(r.jsx)(U.a,{})," ",Object(r.jsx)("div",{children:this.state.countdownTimer}),Object(r.jsx)(F.a,{})," ",Object(r.jsx)("div",{children:e})]})]})})})}},{key:"renderSummary",value:function(){var e=this.state.balance;return Object(r.jsxs)("div",{className:"App",children:[Object(r.jsxs)("div",{className:"total-qtum",children:[Object(r.jsx)("img",{src:ce,alt:"Qtum Raffle"}),Object(r.jsxs)("div",{children:[e," QTUM"]})]}),Object(r.jsxs)("div",{className:"countdown-timer",children:[this.state.countdownTimer," "]})]})}},{key:"renderLoading",value:function(){return Object(r.jsxs)(N.a,{open:this.state.loading,keepMounted:!0,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(r.jsx)(C.a,{children:Object(r.jsx)(T.a,{id:"alert-dialog-description",children:this.state.loadingMessage})}),Object(r.jsx)(A.a,{})]})}},{key:"renderSnackbar",value:function(){return Object(r.jsx)(W.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:this.state.snackbarOpen,autoHideDuration:6e3,onClose:this.handleSnackbarClose,ContentProps:{"aria-describedby":"message-id"},message:Object(r.jsx)("span",{id:"message-id",children:this.state.snackbarMessage}),action:[Object(r.jsx)(B.a,{"aria-label":"Close",color:"inherit",onClick:this.handleSnackbarClose,children:Object(r.jsx)(q.a,{})},"close")]})}},{key:"renderFooter",value:function(){return Object(r.jsx)("footer",{children:Object(r.jsx)("div",{className:"footer-container",children:Object(r.jsxs)("p",{children:["\xa9 2018 QTUM RAFFLE\u2122 | Please install the ",Object(r.jsx)("a",{href:"https://github.com/QtumLightProject/qtum-light-wallet",target:"_blank",children:" Qtum Light Wallet"})," to play this game | Contact: appbery.digital@gmail.com "]})})})}},{key:"renderPlayers",value:function(){var e=this.state.players;return e&&e.length>0?(e.length>4&&(e=e.slice(0,4)),Object(r.jsxs)(R.a,{className:"card small-card",children:[Object(r.jsx)("div",{className:"card-title",children:"Recent Players"}),Object(r.jsx)("hr",{className:"card-title-divider"}),Object(r.jsx)(Y.a,{children:Object(r.jsx)(K.a,{children:e.map((function(e,t){return Object(r.jsx)(te.a,{children:Object(r.jsx)(X.a,{className:"table-cell",children:e})},t)}))})})]})):Object(r.jsxs)(R.a,{className:"card small-card",children:[Object(r.jsx)("div",{className:"card-title",children:"Recent Players"}),Object(r.jsx)("hr",{className:"card-title-divider"}),Object(r.jsx)("p",{children:"No players yet, be quick to be the first!"})]})}},{key:"renderBody",value:function(){var e=this.state,t=e.account;return e.walletInitialized?t?Object(r.jsxs)("div",{className:"main-container",children:[this.renderPlayers(),this.renderBuy(),this.renderContractInfo()]}):Object(r.jsx)("h2",{children:"Please sign in Qtum Light Wallet and refresh the page!"}):null}},{key:"render",value:function(){return Object(r.jsx)(f.MuiThemeProvider,{theme:be,children:Object(r.jsxs)("div",{className:"App",children:[this.renderAppBar(),this.renderSummary(),this.renderBody(),this.renderLoading(),this.renderSnackbar(),this.renderFooter()]})})}}]),a}(c.Component),je=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function fe(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(Object(r.jsx)(he,{}),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("","/service-worker.js");je?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):fe(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):fe(e)}))}}()}},[[419,1,2]]]);
//# sourceMappingURL=main.320f0a2e.chunk.js.map